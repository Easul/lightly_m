layui.use(["jquery","form","util","layer"],function(){var e=layui.$,t=layui.form,a=layui.util,i=layui.layer;null!=layui.data("lightly").user&&(i.msg("已登陆"),e(function(){setTimeout(function(){e(location).attr("href","/main.html")},2e3)})),t.verify({user:[/^[1]([3-9])[0-9]{9}|(20)[0-9]{10}$/,"手机号/学号有误,请重新输入"],pass:[/^[\S]{6,12}$/,"密码必须6到12位，且不能出现空格"],verifyCode:[/^[a-z]{4}$/,"验证码输入错误"]}),e("#verifyCode").click(function(){e("#verifyCode").attr("src","plugin/VerifyCode/GetVerify.php?random="+1e5*Math.random())}),e("#verifyBox").on("input propertychange",function(){4==e(this).val().length&&(i.msg("查询中,请稍后 !",{shade:[.2,"#393D49"]}),e.ajax({type:"GET",url:"plugin/EnterLightly/VerifyCheck.php",data:"vetifyCode="+e(this).val().toLowerCase(),dataType:"json",success:function(t){"yes"==t.status?i.msg("验证码正确,请继续登陆 !"):(i.msg("验证码错误,请重新填写 !"),e("#verifyBox").val(""),e("#verifyBox").focus())}}))}),a.event("lay-active",{register:function(){e(location).attr("href","res/register")}}),t.on("submit(login)",function(t){i.closeAll();var a=i.open({type:3}),r=t.field.user,s=t.field.password,o=t.field.verifyCode;return e.ajax({type:"POST",url:"plugin/EnterLightly/Login.php",data:"user="+r+"&password="+s+"&verifyCode="+o,dataType:"json",success:function(t){switch(i.close(a),t.status){case 0:i.msg("登陆成功！"),layui.data("lightly",{key:"user",value:t.user_table}),layui.data("lightly",{key:"accountInfo",value:{account:r}}),e(function(){setTimeout(function(){e(location).attr("href","/main.html")},2e3)});break;case 1:i.msg("用户名错误！");break;case 2:i.msg("密码错误！");break;case 3:i.msg("每个框不能为空!")}}}),!1})});